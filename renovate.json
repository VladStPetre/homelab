{
  "$schema": "https://docs.renovatebot.com/renovate-schema.json",
  "extends": [
    "config:recommended",
    "schedule:monthly"
  ],

  "enabledManagers": ["docker-compose"],
  "docker-compose": {
    "managerFilePatterns": ["/(^|/)docker-stack\\.ya?ml$/"]
  },
  "dependencyDashboard": true,
  "rebaseWhen": "behind-base-branch",

  "packageRules": [
    {
      "matchManagers": ["docker-compose"],
      "matchFileNames": ["stacks/*/**"],

      "groupName": "stack: {{parentDir}}",
      "groupSlug": "stack-{{parentDir}}",

      "separateMajorMinor": false,
      "separateMinorPatch": false,

      "semanticCommits": "enabled",
      "semanticCommitType": "chore",
      "semanticCommitScope": "stack/{{parentDir}}",
      "commitMessageTopic": "monthly dependency updates for stack/{{parentDir}}",
      "commitMessageAction": "Update",
      "labels": ["dependencies", "renovate", "stack"],
      "prBodyNotes": [
        "This PR groups all Docker image updates found under `{{packageFileDir}}`."
      ]
    }
  ]
}
